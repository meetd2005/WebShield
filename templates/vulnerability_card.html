<h2 class="accordion-header">
    <button class="accordion-button bg-dark text-light" type="button" data-bs-toggle="collapse" 
            data-bs-target="#vuln{{ loop.index }}">
        <div class="d-flex align-items-center w-100">
            <span class="badge bg-{{ vuln.severity|lower }} me-3">{{ vuln.severity|upper }}</span>
            <i class="fas {{ 'fa-exclamation-triangle' if vuln.severity == 'high' 
                           else 'fa-exclamation-circle' if vuln.severity == 'medium'
                           else 'fa-info-circle' }} me-2"></i>
            {{ vuln.type|replace('_', ' ')|title }}
        </div>
    </button>
</h2>
<div id="vuln{{ loop.index }}" class="accordion-collapse collapse" data-bs-parent="#vulnAccordion">
    <div class="accordion-body">
        <div class="mb-4">
            <h6 class="text-info mb-3">
                <i class="fas fa-info-circle me-2"></i>Description
            </h6>
            <div class="bg-dark p-3 rounded border border-secondary">
                {{ vuln.details }}
            </div>
        </div>

        {% if vuln.get('request_data') %}
        <div class="mb-4">
            <h6 class="text-info mb-3">
                <i class="fas fa-arrow-right me-2"></i>HTTP Request
            </h6>
            <div class="bg-dark p-3 rounded border border-secondary">
                <pre class="mb-0"><code class="language-http">Method: {{ vuln.request_data.get('method', 'GET') }}
URL: {{ vuln.request_data.get('url', '') }}
Headers: {{ vuln.request_data.get('headers', {}) | tojson(indent=2) }}
Body: {{ vuln.request_data.get('body', {}) | tojson(indent=2) }}</code></pre>
            </div>
        </div>
        {% endif %}

        {% if vuln.get('response_data') %}
        <div class="mb-4">
            <h6 class="text-info mb-3">
                <i class="fas fa-arrow-left me-2"></i>HTTP Response
            </h6>
            <div class="bg-dark p-3 rounded border border-secondary">
                <pre class="mb-0"><code class="language-http">Status Code: {{ vuln.response_data.get('status_code', 0) }}
Headers: {{ vuln.response_data.get('headers', {}) | tojson(indent=2) }}
Body: {{ vuln.response_data.get('body', '') | tojson(indent=2) }}</code></pre>
            </div>
        </div>
        {% endif %}
    </div>
</div>
